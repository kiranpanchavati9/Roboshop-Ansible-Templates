####################################################################
# 1. Install NodeJS 20 (NodeSource â€“ REQUIRED on Rocky 10)
####################################################################
- name: Add NodeSource NodeJS 20 repository
  ansible.builtin.shell: |
    curl -fsSL https://rpm.nodesource.com/setup_20.x | bash -
  args:
    creates: /etc/yum.repos.d/nodesource-nodejs.repo

- name: Install NodeJS and unzip
  ansible.builtin.dnf:
    name:
      - nodejs
      - unzip
    state: present

- name: App Pre-requisites - Load
  ansible.builtin.import_tasks: app_prereqs.yml

####################################################################
# 6. Install NodeJS dependencies
####################################################################
- name: Install NodeJS dependencies
  ansible.builtin.command: npm install
  args:
    chdir: /app
  become_user: roboshop

- name: Load the Systemd File
  ansible.builtin.import_tasks: systemd.yml